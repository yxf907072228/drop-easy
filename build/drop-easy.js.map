{"version":3,"file":"drop-easy.js","sources":["../src/index.ts"],"sourcesContent":["\r\ninterface DropFunc {\r\n    (e:any):void\r\n}\r\n\r\ninterface DropOption {\r\n    el: Element,\r\n    onDrop?: DropFunc\r\n}\r\n\r\n\r\nfunction readEntitys(entitys:Array<any>){\r\n    return Promise.all(entitys.map((entity)=>{\r\n        return new Promise((resolve, reject)=>{\r\n            if(entity.isDirectory){\r\n                //\r\n                \r\n                let dirReader = entity.createReader();\r\n                dirReader.readEntries((results:Array<any>)=>{\r\n                    readEntitys(results).then((list)=>{\r\n                        resolve({name:entity.name,childs:list})\r\n                    })\r\n                })\r\n\r\n            }else{\r\n                entity.file((file:File)=>{\r\n                    resolve(file);\r\n                })\r\n            }\r\n        })\r\n    }))\r\n}\r\n\r\nexport default function (options: DropOption) {\r\n    let { el, onDrop } = options\r\n    \r\n    document.addEventListener(\"dragleave\",function(e){\r\n            e.preventDefault();\r\n    })\r\n\r\n    document.addEventListener(\"drop\",function(e){\r\n            e.preventDefault();\r\n    })\r\n\r\n    document.addEventListener(\"dragenter\",function(e){\r\n            e.preventDefault();\r\n    })\r\n\r\n    document.addEventListener(\"dragover\",function(e){\r\n            e.preventDefault();\r\n    })\r\n\r\n    el.addEventListener('drop',(e:any)=>{\r\n        \r\n        let fileList = e.dataTransfer.items\r\n        readEntitys(Array.from(fileList).map((item:any)=>{\r\n            let file = item.webkitGetAsEntry()\r\n            return file\r\n        })).then((results)=>{\r\n            options.onDrop&&options.onDrop(results)\r\n        })\r\n\r\n        e.preventDefault()\r\n    })\r\n}\r\n\r\n "],"names":[],"mappings":";;;AAWA,qBAAqB,OAAkB;IACnC,OAAO,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM;QAClC,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM;YAC/B,IAAG,MAAM,CAAC,WAAW,EAAC;gBAGlB,IAAI,SAAS,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;gBACtC,SAAS,CAAC,WAAW,CAAC,CAAC,OAAkB;oBACrC,WAAW,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI;wBAC3B,OAAO,CAAC,EAAC,IAAI,EAAC,MAAM,CAAC,IAAI,EAAC,MAAM,EAAC,IAAI,EAAC,CAAC,CAAA;qBAC1C,CAAC,CAAA;iBACL,CAAC,CAAA;aAEL;iBAAI;gBACD,MAAM,CAAC,IAAI,CAAC,CAAC,IAAS;oBAClB,OAAO,CAAC,IAAI,CAAC,CAAC;iBACjB,CAAC,CAAA;aACL;SACJ,CAAC,CAAA;KACL,CAAC,CAAC,CAAA;CACN;AAED,gBAAyB,OAAmB;IACxC,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,OAAO,CAAA;IAE5B,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAC,UAAS,CAAC;QACxC,CAAC,CAAC,cAAc,EAAE,CAAC;KAC1B,CAAC,CAAA;IAEF,QAAQ,CAAC,gBAAgB,CAAC,MAAM,EAAC,UAAS,CAAC;QACnC,CAAC,CAAC,cAAc,EAAE,CAAC;KAC1B,CAAC,CAAA;IAEF,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAC,UAAS,CAAC;QACxC,CAAC,CAAC,cAAc,EAAE,CAAC;KAC1B,CAAC,CAAA;IAEF,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAC,UAAS,CAAC;QACvC,CAAC,CAAC,cAAc,EAAE,CAAC;KAC1B,CAAC,CAAA;IAEF,EAAE,CAAC,gBAAgB,CAAC,MAAM,EAAC,CAAC,CAAK;QAE7B,IAAI,QAAQ,GAAG,CAAC,CAAC,YAAY,CAAC,KAAK,CAAA;QACnC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,IAAQ;YAC1C,IAAI,IAAI,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;YAClC,OAAO,IAAI,CAAA;SACd,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO;YACb,OAAO,CAAC,MAAM,IAAE,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;SAC1C,CAAC,CAAA;QAEF,CAAC,CAAC,cAAc,EAAE,CAAA;KACrB,CAAC,CAAA;CACL;;;;;;;;"}